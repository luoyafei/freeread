<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cui.shibing.freeread.dao.NovelHeadDao">

	<resultMap id="BaseResultMap" type="cui.shibing.freeread.model.NovelHead">
		<id column="novel_id" jdbcType="INTEGER" property="novelId" />
		<result column="novel_name" jdbcType="VARCHAR" property="novelName" />
		<result column="novel_picture" jdbcType="VARCHAR" property="novelPicture" />
		<result column="novel_content_table_name" jdbcType="VARCHAR"
			property="novelContentTableName" />
		<result column="novel_content_id" jdbcType="INTEGER" property="novelContentId" />
		<result column="novel_class" jdbcType="INTEGER" property="novelClass" />
		<result column="novel_status" jdbcType="INTEGER" property="novelStatus" />
		<result column="novel_chapter_num" jdbcType="INTEGER" property="novelChapterNum" />
		<result column="novel_author" jdbcType="INTEGER" property="novelAuthor" />
		<result column="novel_access" jdbcType="INTEGER" property="novelAccess" />
		<result column="novel_popularity" jdbcType="INTEGER" property="novelPopularity" />
	</resultMap>

	<select id="selectNovelHeadByNovelId" parameterType="java.lang.Integer"
		resultMap="BaseResultMap">
		select
			novel_id, 
			novel_name, 
			novel_picture, 
			novel_content_table_name,
			novel_content_id,
			novel_class, 
			novel_status, 
			novel_chapter_num, 
			novel_author, 
			novel_access,
			novel_popularity
		from 
			novel_head
		where 
			novel_id = #{novelId,jdbcType=INTEGER}
	</select>

	<delete id="deleteNovelHeadByNovelId" parameterType="java.lang.Integer">
		delete from novel_head
		where novel_id = #{novelId,jdbcType=INTEGER}
	</delete>

	<insert id="insertNovelHead" parameterType="cui.shibing.freeread.model.NovelHead">
		insert into novel_head (
			novel_id, 
			novel_name, 
			novel_picture,
			novel_content_table_name, 
			novel_content_id,
			novel_class, 
			novel_status, 
			novel_chapter_num,
			novel_author, 
			novel_access, 
			novel_popularity
		)
		values (
			#{novelId,              jdbcType=INTEGER}, 
			#{novelName,            jdbcType=VARCHAR},
			#{novelPicture,         jdbcType=VARCHAR},
			#{novelContentTableName,jdbcType=VARCHAR},
			#{novelContentId,       jdbcType=INTEGER},
			#{novelClass,           jdbcType=INTEGER}, 
			#{novelStatus,          jdbcType=INTEGER}, 
			#{novelChapterNum,      jdbcType=INTEGER},
			#{novelAuthor,          jdbcType=INTEGER}, 
			#{novelAccess,          jdbcType=INTEGER},
			#{novelPopularity,      jdbcType=INTEGER}
		)
	</insert>
	
	<update id="updateNovelHeadByNovelId" parameterType="cui.shibing.freeread.model.NovelHead">
		update 	
			novel_head
		set 
			novel_name               = #{novelName,            jdbcType=VARCHAR},
			novel_picture            = #{novelPicture,         jdbcType=VARCHAR},
			novel_content_table_name = #{novelContentTableName,jdbcType=VARCHAR},
			novel_content_id         = #{novelContentId,       jdbcType=INTEGER},
			novel_class              = #{novelClass,           jdbcType=INTEGER},
			novel_status             = #{novelStatus,          jdbcType=INTEGER},
			novel_chapter_num        = #{novelChapterNum,      jdbcType=INTEGER},
			novel_author             = #{novelAuthor,          jdbcType=INTEGER},
			novel_access             = #{novelAccess,          jdbcType=INTEGER},
			novel_popularity         = #{novelPopularity,      jdbcType=INTEGER}
		where 
			novel_id = #{novelId,jdbcType=INTEGER}
	</update>

	<select id="selectNovelHeadByNovelName" resultMap="BaseResultMap">
		select
			novel_id, 
			novel_name, 
			novel_picture, 
			novel_content_table_name,
			novel_content_id,
			novel_class, 
			novel_status, 
			novel_chapter_num, 
			novel_author, 
			novel_access,
			novel_popularity
		from 
			novel_head
		where 
			novel_name = #{novelName} 
		limit
			#{pageable.offset},#{pageable.pageSize}
	</select>

	<select id="selectNovelHeadByNovelClassName" resultMap="BaseResultMap">
		select
			nh.novel_id, 
			nh.novel_name, 
			nh.novel_picture, 
			nh.novel_content_table_name,
			nh.novel_content_id,
			nh.novel_class, 
			nh.novel_status, 
			nh.novel_chapter_num,
			nh.novel_author, 
			nh.novel_access,
			nh.novel_popularity
		from 
			novel_head nh,
			novel_class hc
		where 
			(
				nc.novel_class_name1 = #{novelClassName} 
				or
				nc.novel_class_name2 = #{novelClassName} 
				or
				nc.novel_class_name2 = #{novelClassName}
			) 
			and
			(
				nh.novel_class = hc.novel_class_id
			)
		limit
			#{pageable.offset},#{pageable.pageSize}
	</select>

	<select id="selectNovelHeadByPopularity" resultMap="BaseResultMap">
		select
			novel_id, 
			novel_name, 
			novel_picture, 
			novel_content_table_name,
			novel_content_id,
			novel_class, 
			novel_status, 
			novel_chapter_num, 
			novel_author, 
			novel_access,
			novel_popularity
		from 
			novel_head
		order by 
			novel_popularity desc 
		limit
			#{pageable.offset},#{pageable.pageSize}
	</select>

</mapper>